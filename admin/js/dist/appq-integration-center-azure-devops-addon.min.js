!function(d){"use strict";var _x=wp.i18n._x;d(document).ready(function(){d("#azure_devops_settings .field_mapping .remove").click(function(){d(this).parent().remove()}),d("#azure_devops_settings .add_field_mapping").click(function(){var i=d(this);i.attr("disabled","disabled");var e=d('<div><input type="text" placeholder="key" name="key"><input type="text" placeholder="value" name="value"><button class="btn btn-primary">OK</button></div>');e.find("button").click(function(e){e.preventDefault();var a=d(this).parent().find('[name="key"]').val(),t=d(this).parent().find('[name="value"]').val(),n=d('<div class="form-group row"><label class="col-sm-2"></label><textarea class="col-sm-9 form-control" placeholder="Title: {Bug.title}"></textarea><button class="col-sm-1 remove btn btn-danger">-</button></div>');n.find("label").attr("for","field_mapping["+a+"]").text(a),n.find("textarea").attr("name","field_mapping["+a+"]").val(t),n.find(".remove").click(function(){d(this).parent().remove()}),n.insertBefore(i),d(this).parent().remove(),i.removeAttr("disabled")}),e.insertBefore(d(this))}),d("#azure-devops_tracker_settings").submit(function(e){e.preventDefault();var a=d("#campaign_id").val(),t=d("#azure-devops_tracker_settings").serializeArray();t.push({name:"action",value:"appq_azure_devops_edit_settings"}),t.push({name:"cp_id",value:a}),t.push({name:"nonce",value:integration_center_obj.nonce}),jQuery.ajax({type:"post",dataType:"json",url:integration_center_obj.ajax_url,data:t,success:function(e){toastr.success(_x("Tracker settings updated!","Integration Center available fields modal error","appq-integration-center-azure-devops-addon")),location.reload()}})}),d("#azure-devops_mapping_field").submit(function(e){e.preventDefault();var t=d(".fields-list"),a=d("#campaign_id").val(),n=d("#azure-devops_mapping_field").serializeArray(),i=d(this).find('[type="submit"]'),r=i.html();i.html('<i class="fa fa-spinner fa-spin"></i>'),n.push({name:"action",value:"appq_azure_edit_mapping_fields"}),n.push({name:"cp_id",value:a}),n.push({name:"nonce",value:integration_center_obj.nonce}),jQuery.ajax({type:"post",dataType:"json",url:integration_center_obj.ajax_url,data:n,success:function(e){toastr.success(_x("Field added!","Integration Center available fields modal error","appq-integration-center-azure-devops-addon")),i.html(r);var a=wp.template("field_mapping_row")(e.data);d('[data-row="'+e.data.key+'"]').length?d('[data-row="'+e.data.key+'"]').replaceWith(a):t.prepend(a),d("#add_mapping_field_modal").modal("hide")}})}),d(document).on("click",'[data-target="#azure-devops_add_mapping_field_modal"]',function(){var e=d(this).attr("data-target"),a=d(e).find('input[name="name"]'),t=d(e).find('textarea[name="value"]');a.val(""),t.val("");var n=d(this).attr("data-key");if(n){var i=d(this).attr("data-content");a.val(n),t.val(i)}}),d(document).on("click","#azure-devops_fields_settings .delete-mapping-field",function(){var e=d(this).attr("data-key"),a=d(this).attr("data-target");d(a).find('input[name="field_key"]').val(e)}),d("#azure-devops_delete_field").submit(function(e){e.preventDefault();var a=d(".fields-list"),t=d("#campaign_id").val(),n=d("#azure-devops_delete_field").serializeArray(),i=d(this).find('[type="submit"]'),r=i.html();i.html('<i class="fa fa-spinner fa-spin"></i>'),n.push({name:"action",value:"appq_azure_delete_mapping_fields"}),n.push({name:"cp_id",value:t}),n.push({name:"nonce",value:integration_center_obj.nonce}),jQuery.ajax({type:"post",dataType:"json",url:integration_center_obj.ajax_url,data:n,success:function(e){toastr.success(_x("Field deleted!","Integration Center available fields modal error","appq-integration-center-azure-devops-addon")),i.html(r),a.find('[data-row="${msg.data}"]').remove(),d("#delete_mapping_field_modal").modal("toggle")}})})})}(jQuery);