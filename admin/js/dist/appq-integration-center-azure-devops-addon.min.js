!function(l){"use strict";l(document).ready(function(){l("#azure_devops_settings .field_mapping .remove").click(function(){l(this).parent().remove()}),l("#azure_devops_settings .add_field_mapping").click(function(){var i=l(this);i.attr("disabled","disabled");var e=l('<div><input type="text" placeholder="key" name="key"><input type="text" placeholder="value" name="value"><button class="btn btn-primary">OK</button></div>');e.find("button").click(function(e){e.preventDefault();var a=l(this).parent().find('[name="key"]').val(),t=l(this).parent().find('[name="value"]').val(),n=l('<div class="form-group row"><label class="col-sm-2"></label><textarea class="col-sm-9 form-control" placeholder="Title: {Bug.title}"></textarea><button class="col-sm-1 remove btn btn-danger">-</button></div>');n.find("label").attr("for","field_mapping["+a+"]").text(a),n.find("textarea").attr("name","field_mapping["+a+"]").val(t),n.find(".remove").click(function(){l(this).parent().remove()}),n.insertBefore(i),l(this).parent().remove(),i.removeAttr("disabled")}),e.insertBefore(l(this))}),l("#azure-devops_tracker_settings").submit(function(e){e.preventDefault();var a=l("#campaign_id").val(),t=l("#azure-devops_tracker_settings").serializeArray();t.push({name:"action",value:"appq_azure_devops_edit_settings"}),t.push({name:"cp_id",value:a}),t.push({name:"nonce",value:appq_ajax.nonce}),jQuery.ajax({type:"post",dataType:"json",url:appq_ajax.url,data:t,success:function(e){toastr.success(__x("Tracker settings updated!","Integration Center available fields modal error","appq-integration-center")),location.reload()}})}),l("#azure-devops_mapping_field").submit(function(e){e.preventDefault();var t=l(".fields-list"),a=l("#campaign_id").val(),n=l("#azure-devops_mapping_field").serializeArray(),i=l(this).find('[type="submit"]'),r=i.html();i.html('<i class="fa fa-spinner fa-spin"></i>'),n.push({name:"action",value:"appq_azure_edit_mapping_fields"}),n.push({name:"cp_id",value:a}),n.push({name:"nonce",value:appq_ajax.nonce}),jQuery.ajax({type:"post",dataType:"json",url:appq_ajax.url,data:n,success:function(e){toastr.success(__x("Field added!","Integration Center available fields modal error","appq-integration-center")),i.html(r);var a=wp.template("field_mapping_row")(e.data);l('[data-row="'+e.data.key+'"]').length?l('[data-row="'+e.data.key+'"]').replaceWith(a):t.prepend(a),l("#add_mapping_field_modal").modal("hide")}})}),l(document).on("click",'[data-target="#azure-devops_add_mapping_field_modal"]',function(){var e=l(this).attr("data-target"),a=l(e).find('input[name="name"]'),t=l(e).find('textarea[name="value"]');a.val(""),t.val("");var n=l(this).attr("data-key");if(n){var i=l(this).attr("data-content");a.val(n),t.val(i)}}),l(document).on("click","#azure-devops_fields_settings .delete-mapping-field",function(){var e=l(this).attr("data-key"),a=l(this).attr("data-target");l(a).find('input[name="field_key"]').val(e)}),l("#azure-devops_delete_field").submit(function(e){e.preventDefault();var a=l(".fields-list"),t=l("#campaign_id").val(),n=l("#azure-devops_delete_field").serializeArray(),i=l(this).find('[type="submit"]'),r=i.html();i.html('<i class="fa fa-spinner fa-spin"></i>'),n.push({name:"action",value:"appq_azure_delete_mapping_fields"}),n.push({name:"cp_id",value:t}),n.push({name:"nonce",value:appq_ajax.nonce}),jQuery.ajax({type:"post",dataType:"json",url:appq_ajax.url,data:n,success:function(e){toastr.success(__x("Field deleted!","Integration Center available fields modal error","appq-integration-center")),i.html(r),a.find('[data-row="${msg.data}"]').remove(),l("#delete_mapping_field_modal").modal("toggle")}})})})}(jQuery);